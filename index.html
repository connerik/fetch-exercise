<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Home</title>
    <script defer src="https://cdn.jsdelivr.net/gh/hankhank10/alpine-fetch@main/alpine-fetch.js"></script>
    <script src="//unpkg.com/alpinejs" defer></script>
    <script src="https://cdn.jsdelivr.net/npm/@tailwindcss/browser@4"></script>
</head>
<body class="bg-gray-900 text-white dark">
    <div x-data="appManager()" class="bg-gray-900 min-h-screen">
        <nav class="bg-gray-800 border-b border-gray-700">
            <div class="p-4 flex gap-6">
                <button 
                    @click="currentPage = 'home'"
                    :class="{'text-blue-400 border-b-2 border-blue-400': currentPage === 'home', 'text-gray-300 hover:text-white': currentPage !== 'home'}"
                    class="pb-2 font-semibold transition"
                >
                    Home
                </button>
                <a 
                    href="writeup.html"
                    class="pb-2 font-semibold transition text-gray-300 hover:text-white"
                >
                    Write-Up
                </a>
            </div>
        </nav>

        <template x-if="currentPage === 'home'">
            <div class="p-8 bg-gray-900 min-h-screen">
                <div class="bg-blue-900 border border-blue-700 p-4 rounded mb-6">
                    <p class="text-blue-200">This site uses Jikan API to pull information from the Anime database MyAnimeList</p>
                </div>

                <div x-data="animeApp()">
                    <h1 class="text-2xl font-bold mb-4 text-white">Top 25 Anime</h1>
                    
                    <template x-if="loading">
                        <p class="text-gray-400">Loading...</p>
                    </template>
                    
                    <template x-if="error">
                        <p class="text-red-400" x-text="error"></p>
                    </template>
                    
                    <template x-if="!loading && anime.length > 0">
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-12">
                            <template x-for="(item, index) in anime" :key="item.mal_id">
                                <div class="border border-gray-700 bg-gray-800 p-4 rounded shadow hover:shadow-lg transition">
                                    <div class="flex items-start justify-between">
                                        <div>
                                            <h2 class="font-bold text-lg text-white" x-text="item.title"></h2>
                                            <p class="text-sm text-gray-400" x-text="`Ranked #${item.rank}`"></p>
                                        </div>
                                        <span class="bg-blue-600 text-white px-2 py-1 rounded" x-text="`â­ ${item.score}`"></span>
                                    </div>
                                    <p class="text-sm mt-2 text-gray-300" x-text="`Episodes: ${item.episodes || 'Unknown'}`"></p>
                                    <p class="text-sm text-gray-400 mt-2" x-text="item.synopsis?.substring(0, 100) + '...' || 'No synopsis'"></p>
                                </div>
                            </template>
                        </div>
                    </template>
                </div>

                <div x-data="charactersApp()">
                    <h1 class="text-2xl font-bold mb-4 text-white">Top 25 Popular Characters</h1>
                    
                    <template x-if="loading">
                        <p class="text-gray-400">Loading characters...</p>
                    </template>
                    
                    <template x-if="error">
                        <p class="text-red-400" x-text="error"></p>
                    </template>
                    
                    <template x-if="!loading && characters.length > 0">
                        <div class="grid grid-cols-2 md:grid-cols-4 lg:grid-cols-5 gap-4">
                            <template x-for="(character, index) in characters" :key="character.mal_id">
                                <div class="bg-gray-800 rounded shadow hover:shadow-lg transition overflow-hidden">
                                    <img :src="character.images.jpg.image_url" :alt="character.name" class="w-full h-64 object-cover" />
                                    <div class="p-3">
                                        <h3 class="font-bold text-sm text-white text-center truncate" x-text="character.name"></h3>
                                        <p class="text-xs text-gray-400 text-center" x-text="`#${index + 1}`"></p>
                                    </div>
                                </div>
                            </template>
                        </div>
                    </template>
                </div>
            </div>
        </template>


    </div>

    <script>
        function appManager() {
            return {
                currentPage: 'home'
            };
        }

        function animeApp() {
            return {
                anime: [],
                loading: true,
                error: null,

                async init() {
                    try {
                        const response = await fetch(
                            'https://api.jikan.moe/v4/top/anime?limit=25'
                        );
                        
                        if (!response.ok) {
                            throw new Error(`API error: ${response.status}`);
                        }
                        
                        const data = await response.json();
                        this.anime = data.data || [];
                    } catch (err) {
                        this.error = `Failed to fetch anime: ${err.message}`;
                        console.error('Fetch error:', err);
                    } finally {
                        this.loading = false;
                    }
                }
            }
        }

        function charactersApp() {
            return {
                characters: [],
                loading: true,
                error: null,

                async init() {
                    try {
                        const response = await fetch(
                            'https://api.jikan.moe/v4/top/characters?limit=25'
                        );
                        
                        if (!response.ok) {
                            throw new Error(`API error: ${response.status}`);
                        }
                        
                        const data = await response.json();
                        this.characters = data.data || [];
                    } catch (err) {
                        this.error = `Failed to fetch characters: ${err.message}`;
                        console.error('Fetch error:', err);
                    } finally {
                        this.loading = false;
                    }
                }
            }
        }
    </script>
</body>
</html>